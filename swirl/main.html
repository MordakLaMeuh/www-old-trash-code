<!DOCTYPE html>
<html>
<head>
	<title>Little Fox-Box</title>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="chatbox html 1.0">
	<meta name="author" content="mordak">
	<link href="data:image/x-icon;base64,AAABAAEAEBAAAAEACABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAVFREAAAAAAAIDAADt+P8A7/X/AC2LuwAsLi4A8f7/APn5+QD7//AA+/v/AP/8+QD9+/8A/v/5AIZ6kAD//v8AKYz0AA4mVgCLh5MAnaKkABgyOwAwN3YA+fT0APP8+gBEn9MA8//6APn5+gBBnuIA3K/tAP369AD3/f0AIxkVAE4+QwD9/f0AvcXEAP79/QD//f0ADWKvAEab/QBwruQAoLzFALCxtgDo8vgA8PPyAPn4+AARPmAA+Pr+ALTj+gD9+vUAPJr7APv6/gD/+PgA/vr+AP79/gD///sAJYz2ANrY0ABaYmcAx8TCAGJfXgDDx8sA3/r/AAQvYQCkmZ0Ax8fLAPPz8wDr+v8AExQsAPf58wBYru8A+PT/APv39gD8+/AA+fv5APf++QD5+v8A/Pv5AAFktwD8/PwA/fz8AP79/wDCw8AAGh8yAP/9/wDp7esAG5n6AE+k7QDM6fIADWLMAE2BzQDw9v0A9/f3APn39wAkhewAv8C4APz7+gA3rfcA//76AP7//QBbWWkA///9AJahpQBSm+4ATmiNAOv3+AACNWwATk1hAOb//gBAc64AJyo5ADSc8gABABcA4L7EAPv7+wBElvIALW6pAC57owB3cXsADECWANbO/QBDNjAA7vb2AOz2/wDw+f8A9vb2AO///wAFGE0AExwsAAIDGAD3+/wA+fv8AP/48wA9peoA/fn/AP/7/AD//P8A/v//AMfAugBGmPkA////AHVufAAiJCkAJpjxAPHx8QCAcnYAJklhAJCMjQDz/+4A8v/3APX7/QAONnEA+vr6ABQ9YgD8+/0A/f36AP37/QAblvUARHjIAP/+/QADR4kAGgEBAKKQogDFwM0AKZT4ADyR3QAofskAADR1ACRAdADz9fUAEi9mADKl7AAOHy4A+/T7AFhYWAD3+/4A/P71AP//7wD/+/4A/v7+ABp8xACXnZ0ADQ4OAL/PvAA2cKkAx8jCABYODgAEEDgAL5rnAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEDCnkHen17LoWaTF+IAQEBsDBAUYM6ibhePK6ClwEBAUJ+JXOmTSdvkFJ/WkkBAQEidBBmaWCgH4yRALEyAQEBtChFYz6knxR1bI1IaAEBARNwoZOpMVVXRDdDYh4BAQE/ZXiGknZWhxe3OSNLAQEBKSAdrA5YjgkSL4AzRgEBAQ19PXccFbpdZ50FtgQBAQFTsQtqpYS7nG4YGzgZAQEBlWuvollyiiajqqcqlAEBAZ4WDJizLa07ApYRuUoBAQEjYVSrbSGLW4uoBrWoAQEBUGQ2K4EIi0FxCIuPiwEBAZsPRzZksk58cSMhi1wBAQE0U5kaCLIIi7I1LE8kAcABAADAAQAAwAEAAMABAADAAQAAwAEAAMABAADAAQAAwAEAAMABAADAAQAAwAEAAMABAADAAQAAwAEAAMABAAA=" rel="icon" type="image/x-icon" />
	<style type="text/css">
		*	{
			padding: 0px;
			margin: 0px;
		}
		body 	{
			display: block;
			background-image: url("./stuff/matrix.jpg");
			background-repeat: repeat;
			background-position: center top;
			color: #00cc00;
			font-family: monospace;
    			height:100vh;
    			width: 100vw;
    			overflow: hidden;			/* Compensation de l'abs. de la propriété fixed pour smartphone. A ENLEVER DANS LA VERSION FINALE. */
		}
		span {
			font-style: italic;
			font-size: 2.5vh;
		}
		a {
			display:block;
		}
		.computer {					/* La propriété position:fixed permet d'optimiser l'affichage sur PC mais gene sur smartphone car elle empeche de sa balader sur la page. */
			position: fixed;
		}
		#devices {
			position: absolute;
			height: 30vh;
			width: 60vw;
			text-align: center;
			top: 35vh;
			left: 20vw;
		}
		.device {
			width: 30vh;
			height: 100%;
			display: inline-block;
		}
		.dark_Linux {
			width: 100%;
			height: 100%;
		}
	</style>
	<link rel='stylesheet' href='modulableWindow.css' type='text/css' media='all'>
</head>

<body>
<div id='devices'>
	<div class='device' id='computer'>
		<img class='dark_Linux' src='./stuff/linux.png' alt='darkLinux'/>
	</div>
	<div class='device' id='smartphone'>
	<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="100%" width="100%" version="1.1" viewBox="-147 -70 294 345">
		<g fill="#2E2E8E">
			<g stroke="transparent" stroke-width="7.2">
				<rect rx="6.5" transform="rotate(29)" height="86" width="13" y="-86" x="14"/>
				<rect rx="6.5" transform="rotate(-69)" height="86" width="13" y="-86" x="14"/>
				<rect rx="24" height="133" width="48" y="41" x="-143"/>
				<rect rx="24" height="133" width="48" y="41" x="96"/>
				<rect rx="24" height="133" width="48" y="138" x="-58"/>
				<rect rx="24" height="133" width="48" y="138" x="10"/>
			</g>
			<ellipse cy="41" rx="91" ry="84"/>
			<rect rx="22" height="182" width="182" y="20" x="-91"/>
		</g>
		<g stroke="green" stroke-width="7.2" fill="#FFF">
			<path d="m-95 44.5h190"/><circle cx="-42" r="4"/><circle cx="42" r="4"/>
		</g>
	</svg>
	</div>
</div>

<svg height='100%' id='MW_SVG_CLOSE' class='MW_Svg_Icon MW_Svg_Icon_Right MW_Svg_Hidden' viewBox="0 0 200 200"  xml:lang="fr">		<!-- CLOSE ICON -->
	<line x1="30" y1="30" x2="170" y2="170" style="stroke-width:20px;" />
	<line x1="30" y1="170" x2="170" y2="30" style="stroke-width:20px;" />
</svg>
<svg height='100%' id='MW_SVG_MAXIMIZE' class='MW_Svg_Icon MW_Svg_Icon_Right MW_Svg_Hidden' viewBox="0 0 200 200" xml:lang="fr">		<!-- MAXIMIZE ICON -->
	<rect x="30px" y="40px" width="140" height="120" style="stroke-width:20px; fill:none;" />
</svg>
<svg height='100%' id='MW_SVG_MAXIMIZE_INVERSE' class='MW_Svg_Icon MW_Svg_Icon_Right MW_Svg_Hidden' viewBox="0 0 200 200" xml:lang="fr">	<!-- MAXIMIZE INVERSE ICON -->
	<rect x="25px" y="25px" width="140" height="125" style="stroke-width:20px; fill:none;"/>
	<rect x="50px" y="50px" width="140" height="125" style="stroke-width:20px; fill:none;"/>
</svg>
<svg height='100%' id='MW_SVG_MINIMIZE' class='MW_Svg_Icon MW_Svg_Icon_Right MW_Svg_Hidden' viewBox="0 0 200 200" xml:lang="fr">		<!-- MINIMIZE ICON -->
	<line x1="30" y1="160" x2="170" y2="160" style="stroke-width:30px;" />
</svg>
<svg height='100%' id='MW_SVG_OPACITY' class='MW_Svg_Icon MW_Svg_Icon_Left MW_Svg_Hidden' viewBox="0 0 200 200" xml:lang="fr">		<!-- OPACITY ICON -->
	<circle cx="70" cy="100" r="60" 	style="stroke-width:20px; fill:none;"/>
	<circle cx="130" cy="100" r="60" 	style="stroke-width:20px; fill:none;"/>
</svg>
<svg height='100%' id='MW_SVG_HEADERLESS' class='MW_Svg_Icon MW_Svg_Icon_Left MW_Svg_Hidden' viewBox="0 0 200 200" xml:lang="fr">		<!-- HEADERLESS ICON -->
  	<polygon points="100,20 40,180 180,78 20,78 160,180" style="fill:none; stroke-width:10px; fill-rule:nonzero;" />
</svg>
<svg height='100%' id='MW_SVG_PROPORTIONS' class='MW_Svg_Icon MW_Svg_Icon_Left MW_Svg_Hidden' viewBox="0 0 200 200" xml:lang="fr">		<!-- PROPORTIONS ICON -->
  	<line x1="30" y1="160" x2="170" y2="160" 	style="stroke-width:20px; stroke-linecap:round;" />
  	<polygon points="170,160 130,130 130,190" style="stroke-width:10px; fill-rule:nonzero;" />
  	<line x1="30" y1="140" x2="30" y2="20" 	style="stroke-width:20px; stroke-linecap:round;" />
  	<polygon points="30,20 0,50 60,50" 		style="stroke-width:10px; fill-rule:nonzero;" />
</svg>
<svg height='100%' id='MW_SVG_BACKROOM' class='MW_Svg_Icon MW_Svg_Icon_Left MW_Svg_Hidden' viewBox="0 0 200 200" xml:lang="fr">		<!-- BACKROOM ICON -->
	<circle cx="100" cy="100" r="20" 	style="stroke-width:10px; fill:none;"/>
	<circle cx="100" cy="100" r="50" 	style="stroke-width:10px; fill:none;"/>
	<circle cx="100" cy="100" r="80" 	style="stroke-width:10px; fill:none;"/>
</svg>
<svg height='100%' id='MW_SVG_MEDIA_PLAY' class='MW_Svg_Hidden media_Controls_Icons' viewBox="0 0 200 200" xml:lang="fr">			<!-- VID PLAY ICON -->
  	<polygon points="20,20 20,180 180,100" style="stroke-width:10px;"/>
</svg>
<svg height='100%' id='MW_SVG_MEDIA_PAUSE' class='MW_Svg_Hidden media_Controls_Icons' viewBox="0 0 200 200" xml:lang="fr">			<!-- VID PAUSE ICON -->
	<line x1="66" y1="20" x2="66" y2="180" style="stroke-width:30px;"/>
	<line x1="133" y1="20" x2="133" y2="180" style="stroke-width:30px;"/>
</svg>
<svg height='100%' id='MW_SVG_MEDIA_SOUND' class='MW_Svg_Hidden media_Controls_Icons' viewBox="0 0 512 512" xml:lang="fr">			<!-- VID SOUND ICON -->
	<path d="M160,96v304.625C142.984,390.406,120.703,384,96,384c-53.016,0-96,28.656-96,64s42.984,64,96,64s96-28.656,96-64V256l288-96 v144.625C463,294.406,440.688,288,416,288c-53,0-96,28.656-96,64s43,64,96,64s96-28.656,96-64V0L160,96z M96,480
		c-39.063,0-64-18.938-64-32s24.938-32,64-32s64,18.938,64,32S135.063,480,96,480z M192,224v-72.719l288-78.563V128L192,224z
		M416,384c-39.063,0-64-18.938-64-32s24.938-32,64-32s64,18.938,64,32S455.063,384,416,384z"/>
</svg>
<svg height='100%' id='MW_SVG_UPLOAD' class='MW_Svg_Icon MW_Svg_Icon_Right MW_Svg_Hidden' viewBox="0 0 200 200" xml:lang="fr">		<!-- UPLOAD ICON -->
	<line x1="100" y1="30" x2="100" y2="170" style="stroke-width:10px;" />
	<polygon points="100,30 40,100 160,100" 	style="stroke-width:10px; fill-rule:nonzero;" />
</svg>
<svg height='100%' id='MW_SVG_DOWNLOAD' class='MW_Svg_Icon MW_Svg_Icon_Right MW_Svg_Hidden' viewBox="0 0 200 200" xml:lang="fr">		<!-- DOWNLOAD ICON -->
	<line x1="100" y1="30" x2="100" y2="170" style="stroke-width:10px;" />
	<polygon points="100,170 40,100 160,100" style="stroke-width:10px; fill-rule:nonzero;" />
</svg>

<div id='chat' style='display: none'>
	<header>
		<div class="input-file-container">
			<input id="fileInput"  class="input-file" type="file" multiple>
			<div class="input-file-trigger">
				<svg height='100%' viewBox="0 0 16 16" xml:lang="fr">
					<path class="path1" d="M16 8c0-4.418-3.582-8-8-8s-8 3.582-8 8c0 3.438 2.169 6.37 5.214 7.501l-0.214 0.499h6l-0.214-0.499c3.045-1.131 5.214-4.063 5.214-7.501zM7.606 9.919c-0.356-0.153-0.606-0.507-0.606-0.919 0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.412-0.25 0.766-0.606 0.919l-0.394-0.919-0.394 0.919zM8.41 9.958c0.908-0.189 1.59-0.994 1.59-1.958 0-1.105-0.895-2-2-2s-2 0.895-2 2c0 0.964 0.682 1.768 1.59 1.957l-1.166 2.721c-1.425-0.612-2.424-2.028-2.424-3.677 0-2.209 1.791-4.188 4-4.188s4 1.978 4 4.188c0 1.649-0.999 3.066-2.424 3.677l-1.166-2.72zM10.757 15.433l-1.155-2.695c1.976-0.668 3.398-2.537 3.398-4.738 0-2.761-2.239-5-5-5s-5 2.239-5 5c0 2.201 1.422 4.070 3.398 4.738l-1.155 2.695c-2.494-1.070-4.24-3.547-4.24-6.433 0-3.865 3.133-7.185 6.997-7.185s6.997 3.32 6.997 7.185c0 2.886-1.747 5.363-4.24 6.433z"></path>
				</svg>
			</div>
		</div>
	</header>

	<div id="chatTab">
		 <noscript><H1>Javascipt doit être activé pour que la chatBox puisse fonctionner !</H1></noscript>
	</div>

	<footer>
		<form method='POST' action='javascript:postMsg()'>
			<input spellcheck='false' autocomplete='off' type='text' autofocus>	<!-- La propriété autofocus ici est génante sur smartphone. -->
		</form>
	</footer>
</div>

<script type="text/javascript" src="modulableWindow.js"></script>
<script type="text/javascript" src="rtc.js"></script>

<script type="text/javascript">
//window.ondragstart = function(e)  	 { e.preventDefault(); } 		// IMPORTANT - FIX BUG
//document.onmousedown = function(e)  	 { e.preventDefault(); } 		// IMPORTANT - FIX BUG / DISABLE AUTOMATIC SELECT OF ELEMENT

'use strict';
var smartphone;
document.getElementById('computer').onmousedown = function(e) {
	smartphone = false;
	document.body.classList.add('computer');

	var win0 = DOM.create_New_Window('th. du complot',{'x':70,'y':30,'w':30,'h':70},{'border':'#e74c3c','body':'black'},{'type':'video','url':'./stuff/complot.mp4','ratio':true,'opacity':true});
	var win1 = DOM.create_New_Window('Macaron',{'x':37,'y':28,'w':40,'h':45},{'border':'#f1c40f','body':'#ecf0f1'},{'type':'image','url':'./stuff/macaron.jpg','ratio':true});
	var win2 = DOM.create_New_Window('Farador',{'x':0,'y':0,'w':90,'h':60},{'border':'#2980b9','body':'black'},{'type':'video','url':'./stuff/farador.mp4','ratio':true});
	var win3 = DOM.create_New_Window('Raw Text',{'x':58,'y':4,'w':40,'h':25},{'border':'#9b59b6','body':'#220022'},{'type':'rawTxt'});
	var win4 = DOM.create_New_Window('Duck Duck Go !',{'x':50,'y':56,'w':30,'h':40},{'border':'#c0392b','body':'#2E1043'},{'type':'iframe','url':'http://www.duckduckgo.com','noheader':true});
	var win5 = DOM.create_New_Window('Reality Revisited',{'x':5,'y':35,'w':40,'h':60},{'border':'#c0392b','body':'#002200'},{'type':'iframe','url':'http://192.168.0.100/Realityrevisited.V2.0/'});
	var fox_Box = DOM.create_New_Window('chatbox du futur',{'x':2,'y':42,'w':35,'h':50},{'border':'#00CC00','body':'#002200'},{'type':'customContent','id':'chat','fullscreen':true,'opacity':false});

	new main();
	e.preventDefault();
}

document.getElementById('smartphone').onmousedown = function(e) {
	smartphone = true;

	var fox_Box = DOM.create_New_Window('chatbox du futur',{'x':2,'y':42,'w':35,'h':50},{'border':'#00CC00','body':'#002200'},{'type':'customContent','id':'chat','fullscreen':true,'opacity':false});

	new main();
	e.preventDefault();
}

var main = function() {
	document.getElementById('devices').style.display = 'none';
	var chat = new Chatbox();
	//display = function(msg) { chat.display(msg); }
	postMsg = function()	{ chat.postMsg();  }
	server.set_Identify_Field(document.getElementsByTagName("form")[0]);
	server.connect();
}


//var display = function() {}
var postMsg = function() {}
var formInput;
var user_To_Share = false;

var Chatbox = function() {
	this.postMsg = (function()
	{
		var Z = new RegExp("^/");
		var A = new RegExp("^/share ");
			var A1 = new RegExp("^/new ");
			var A2 = new RegExp("^/renew ");
			var A3 = new RegExp("^/close ");
		var B = new RegExp("^/exit$");
		var C = new RegExp("^/connect$");

		var constructor = function() {
			if (formInput.value.match(Z)) {
				if (formInput.value.match(A)) {
					var result = formInput.value.replace(A,'');
					if (result.match(A1)) {
						result = result.replace(A1,'');
						for (var i=0, len=server.users_List.length; i<len; i++) {
							if (result == server.users_List[i]) {
								user_To_Share = result;
								display(RTC.initializeNewInstance(server.user,user_To_Share,false)+'\n');
								formInput.value = null;
								return;
							}
						}
						display("Vous ne pouvez partager avec un ami inexistant !\n");
					}
					else if (result.match(A2)) {
						result = result.replace(A2,'');
						for (var i=0, len=server.users_List.length; i<len; i++) {
							if (result == server.users_List[i]) {
								user_To_Share = result;
								display(RTC.initializeNewInstance(server.user,user_To_Share,true)+'\n');
								formInput.value = null;
								return;
							}
						}
						display("Vous ne pouvez partager avec un ami inexistant !\n");
					}
					else if (result.match(A3)) {
						result = result.replace(A3,'');
						for (var i=0, len=server.users_List.length; i<len; i++) {
							if (result == server.users_List[i]) {
								user_To_Share = result;
								display(RTC.closeSession(user_To_Share)+'\n');
								formInput.value = null;
								return;
							}
						}
						display("Vous ne pouvez clore une session avec un ami inexistant !\n");
					}
					else	display("Comande /share incompréhensible !\n");
				}
				else if (formInput.value.match(B)) {
					RTC.closeAllSessions();
					server.disconnect();
				}
				else if (formInput.value.match(C)) server.connect();
				else server.send('CHAT',formInput.value);
			}
			else 	server.send('CHAT',formInput.value);
			formInput.value = null;
		}
		return constructor;
	})();

	var File_Center = (function(){
		var fileInput = document.getElementById('fileInput');

		fileInput.addEventListener('change', function(e) {
			if (fileInput.files.length == 1) DOM.create_New_Window(fileInput.files[0].name,false,false,false,{'type':'upload','file':fileInput.files[0]});
			else RTC.sendFile(fileInput.files,user_To_Share);
		});
	})();

	var chatTab = document.getElementById("chatTab");
	chatTab.innerHTML = "";

	var mousewheelevt=(/Firefox/i.test(navigator.userAgent))? "DOMMouseScroll" : "mousewheel";
	chatTab.addEventListener(mousewheelevt, function(e) {
		var e = window.event || e; // old IE support
		var delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));
		chatTab.scrollTop -= delta*20;
	}, false);

	window.display = function(msg) {
		chatTab.innerHTML+=msg;
		chatTab.scrollTop+=10000;
	}

	formInput = document.getElementsByTagName("input")[1];
}

var NodeServer = function(ip,port_Order) {
	var password = false;

	var serverType = { 			// 1-L'utilisation de l'API crypto passe forcément pas une page HTTPS sur la dernière version de chrome
		ssl	: false,			// 2-Aucune regression de sécurité n'est possible, si la page source est HTTPS le serveur node doit etre SSL aussi.
		ws	: 'ws://'+ip+':'+(port_Order+81)+'/',
		wss	: 'wss://'+ip+':'+(port_Order+444)+'/'
	};
	var addr=(serverType.ssl || location.protocol == 'https:')?serverType.wss:serverType.ws;

	var txtNode;
	this.set_Identify_Field = function(identify_Field) {
		txtNode = identify_Field.insertBefore(document.createTextNode(''),identify_Field.firstChild);
	}

	var self = this;
	this.users_List = new Array();
	this.user = "";

	var socket = null;
	var open = function() { display("Connexion au serveur réussie.\n"); }
	var error = function() { display("Aucune réponse du serveur. Vous ne pouvez rien y faire !\n");  }
	var message = function(str){
		console.log('msg received from server:'+str);
		var obj = JSON.parse(str.data);
		switch (obj.type) {
			case 'SERVER':
				console.log(JSON.stringify(obj));
				if (obj.password) {
					display("valid password.\n");
					txtNode.nodeValue = 'IDENTIFIEZ-VOUS:';
					password = false;
					return;
				}
				if (password) return;

				if (obj.kick) {											// Réponse du berger à la bergère, tant que le pseudo n'est pas bon, le serveur répond 'kick' !
					display("Ce pseudo là est déjà enregistré, veuillez en utiliser un autre...\n");
				}
				else if (obj.name) {
					console.log('enregistrement du nom de user:'+obj.name);
					self.user = obj.name;
					formInput.setAttribute("style","width:98%");
					txtNode.nodeValue = null;
				}
				else if (obj.new) {
					console.log(obj.new+' length:'+obj.new.length);					// new possède la liste du ou des nouveaux arrivants.
					for (var i=0, len=obj.new.length; i<len; i++) self.users_List.push(obj.new[i]);
				}
				else if (obj.out) {										// out informe qu'un client est partit ! in-out in-out
					for (var i=0, len=self.users_List.length; i<len; i++) {
						if (obj.out == self.users_List[i]) {
							self.users_List.splice(i,1);
							break;
				}}}
				console.log('current user list ->'+self.users_List.join(' '));
				break;
			case 'CHAT':
				display(obj.data);
				break;
			case 'OFFER':
				console.log('offer received'+JSON.stringify(obj.data));
				RTC.initializePeerInstance(obj.from,obj.to,obj.data);
				break;
			case 'ANSWER':
				console.log('answer reveived'+JSON.stringify(obj.data));
				RTC.launchSeeding(obj.from,obj.data);
				break;
			default:
				console.log('other datas');
				break;
		}
	};
	this.send = function(type,data) {
		if (socket.readyState != 1) {
			display("Vous n'etes pas connecté au serveur. essayez /connect\n");
		}
		else {
			socket.send(JSON.stringify	({
			type: type,
			data: data
		}))}
	}
	this.send_RTC = function(type,to,from,data) {
		socket.send(JSON.stringify	({
			type	: type,
			to    : to,
			from 	: from,
			data  : data
						}))
	}
	this.connect = function() {
		if (socket && (socket.readyState == 1)) {
			display('Déjà connecté !\n');
			return;
		}
		formInput.setAttribute("style","width:40%");

		if ((password = false) == true) 	txtNode.nodeValue = 'ENTER PASSWORD:';					// Set if client-side password requirement is enabled or disabled.
		else						txtNode.nodeValue = 'IDENTIFIEZ-VOUS:';

		socket = new WebSocket(addr);
		socket.onopen	= function()	{ open();  		};
		socket.onmessage  = function(data)	{ message(data); 	};
		socket.onerror 	= function() 	{ error(); 		};
	}
	this.disconnect = function() {
		if (socket.readyState == 1) {
			socket.onopen    = null;
			socket.onmessage = null;
			socket.onerror   = null;
			socket.close();
			display("Déconnexion du serveur enregistrée. Have a nice day !\n");
		}
		else  display("vous n'etes actuellement pas connecté au serveur.\n");
	}
}
var server = new NodeServer('127.0.0.1',8000);
var DOM = new MW();
var RTC = new Web_RTC();
</script>
</body>
</html>
